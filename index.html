<!INVENTARIO UFT>
<html>
<head>
  <title>FORMULARIO DE INVENTARIO</title>
<style>
  body {
    text-align: center; /* Centra el contenido de la página */
    margin: 0; /* Elimina márgenes predeterminados */
    font-family: 'Calibri', sans-serif;
  }

  .logo-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 150px;
    /*background-color: #f5f5f5;*/
    margin-bottom: 20px;
  }

  h1 {
    color: #9E1B32;
    margin-top: 0;
  }

  .form-container {
    display: flex;
    justify-content: center;
    gap: 20px; /* Espacio entre los grupos de formulario */
    margin-bottom: 20px; /* Espacio debajo del formulario */
  }

  .form-group {
    display: flex;
    flex-direction: column; /* Asegura que los elementos de cada grupo estén alineados verticalmente */
    align-items: flex-start;
  }

  label {
    color: blue;
    font-weight: bold;
    margin-bottom: 5px;
  }

  select {
    border: 2px solid lightblue;
    padding: 5px;
    font-size: 14px;
    border-radius: 10px;
    width: 200px; /* Ajusta el ancho */
  }

  button {
    background-color: #00BFFF;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
  }

  button:hover {
    background-color: #009ACD;
  }

  table {
    margin: 20px auto;
    border-collapse: collapse; /* Colapsa los bordes */
    width: 80%;
    border: 2px solid rgba(255, 255, 255, 0.7); /* Borde blanco semitransparente */
    border-radius: 5px; /* Bordes redondeados */
    background-color: #f9f9f9; /* Fondo general de la tabla */
  }

  th {
    color: #9E1B32;
    background-color: #f2f2f2; /* Fondo para los encabezados */
    padding: 10px;
    border: 2px solid rgba(255, 255, 255, 0.7); /* Bordes ligeros en encabezados */
  }

  td {
    color: blue;
    background-color: #f9f9f9; /* Fondo para las celdas */
    padding: 8px;
    text-align: center;
    border: 2px solid rgba(255, 255, 255, 0.7); /* Bordes ligeros en celdas */
  }

  table td {
    word-wrap: break-word; /* Ajusta el texto largo */
  }
</style>


  <script>
    async function fetchData() {
      try {
        const user = document.getElementById('user').value;
        const type = document.getElementById('type').value;

        // Llama a la API
        const response = await fetch('https://script.google.com/macros/s/AKfycbyUuY4wRFK0ZFp3oPLC154SKSAmSCY-POhTwzKdzRQrj9USi8Uc7uZAjDIm5TM7fDzE/exec'); // Reemplaza con el enlace de tu API
        const data = await response.json();

        // Imprime los datos obtenidos
        console.log("Datos recibidos:", data);

        // Filtra los datos según el usuario seleccionado
        const filteredData = data.filter(row => row[0] === user);
        console.log("Datos filtrados por usuario:", filteredData);

        // Filtra por el tipo de equipo
        let result;
        if (type === 'CPU') {
          result = filteredData.map(row => row.slice(1, 9)); // Bloque de CPU
        } else if (type === 'MONITOR') {
          result = filteredData.map(row => row.slice(9, 17)); // Bloque de MONITOR
        } else if (type === 'TECLADO') {
          result = filteredData.map(row => row.slice(17, 25)); // Bloque de TECLADO
        } else if (type === 'ESTABILIZADOR') {
          result = filteredData.map(row => row.slice(25, 33)); // Bloque de ESTABILIZADOR
        }
        console.log("Datos filtrados finales:", result);

        // Muestra los datos en la tabla
        displayData(result);
      } catch (error) {
        console.error("Error al obtener los datos:", error);
      }
    }

    function displayData(data) {
      const table = document.getElementById('resultTable');
      table.innerHTML = ''; // Limpia los datos previos

      if (data && data.length > 0) {
        // Crear encabezados de la tabla
        const headers = ['Marca', 'Modelo', 'Número de Serie', 'Código Patrimonial', 'Código Interno', 'Estado', 'Funcionamiento', 'Año de Adquisición'];
        const thead = document.createElement('thead');
        const tr = document.createElement('tr');
        headers.forEach(header => {
          const th = document.createElement('th');
          th.textContent = header;
          tr.appendChild(th);
        });
        thead.appendChild(tr);
        table.appendChild(thead);

        // Crear filas de datos
        const tbody = document.createElement('tbody');
        data.forEach(row => {
          const tr = document.createElement('tr');
          row.forEach(cell => {
            const td = document.createElement('td');
            td.textContent = cell || 'N/A'; // Muestra 'N/A' si no hay datos
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
        table.appendChild(tbody);
      } else {
        // Mostrar mensaje si no hay datos
        table.innerHTML = '<tr><td colspan="8">No hay datos disponibles</td></tr>';
      }
    }
  </script>
</head>

<body>
  <div class="logo-container">
    <img src="https://github.com/admin-personal/inventario_UFT/blob/main/logo14.png?raw=true" alt="Logo">
  </div>

  <h1>FORMULARIO DE INVENTARIO</h1>

  <div class="form-container">
    <div class="form-group">
      <label for="user">Usuario:</label>
      <select id="user">
        <option value="MEREL FARIAS CARLOS ENRIQUE">MEREL FARIAS CARLOS ENRIQUE</option>
        <option value="SILVA RETO TANIA ELIZABETH">SILVA RETO TANIA ELIZABETH</option>
      </select>
    </div>

    <div class="form-group">
      <label for="type">Tipo de equipo:</label>
      <select id="type">
        <option value="CPU">CPU</option>
        <option value="MONITOR">MONITOR</option>
        <option value="TECLADO">TECLADO</option>
        <option value="ESTABILIZADOR">ESTABILIZADOR</option>
      </select>
    </div>
  </div>

  <button onclick="fetchData()">Buscar</button>

  <table id="resultTable" border="1">
    <!-- Aquí se mostrarán los datos -->
  </table>
</body>
</html>

